heuristic_with_defend_v6